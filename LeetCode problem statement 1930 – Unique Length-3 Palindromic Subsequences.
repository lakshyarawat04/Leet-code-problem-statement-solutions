#include <stdio.h>
#include <string.h>
#include <stdbool.h>

int countPalindromicSubsequence(char * s) {
    int n = strlen(s);
    int first[26], last[26];

    // Initialize first to +infinity-like and last to -1
    for (int i = 0; i < 26; i++) {
        first[i] = n;   // something larger than any valid index
        last[i] = -1;
    }

    // Find first and last occurrence of each character
    for (int i = 0; i < n; i++) {
        int idx = s[i] - 'a';
        if (i < first[idx]) first[idx] = i;
        if (i > last[idx])  last[idx] = i;
    }

    int result = 0;

    // For each possible outer character 'a' to 'z'
    for (int c = 0; c < 26; c++) {
        if (first[c] < last[c]) {
            bool seen[26] = {false};

            // Look at all characters between first[c] and last[c]
            for (int i = first[c] + 1; i < last[c]; i++) {
                int mid = s[i] - 'a';
                seen[mid] = true;
            }

            // Count distinct middle characters
            int countDistinct = 0;
            for (int x = 0; x < 26; x++) {
                if (seen[x]) countDistinct++;
            }

            result += countDistinct;
        }
    }

    return result;
}
